# Docker Profile Configuration for Identity Service
# This profile is activated when SPRING_PROFILES_ACTIVE=docker

# Database Configuration - Connect to postgres container
# IMPORTANT: Override the default localhost with postgres container hostname
spring.datasource.url=jdbc:postgresql://postgres:5432/focushive_identity
spring.datasource.username=${DB_USERNAME:focushive_user}
spring.datasource.password=${DB_PASSWORD:focushive_pass}

# Flyway Configuration - Ensure it uses the same datasource
spring.flyway.url=jdbc:postgresql://postgres:5432/focushive_identity
spring.flyway.user=${DB_USERNAME:focushive_user}
spring.flyway.password=${DB_PASSWORD:focushive_pass}

# Redis Configuration - Connect to redis container
spring.data.redis.host=${REDIS_HOST:redis}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:redis_pass}

# Logging for Docker
logging.level.root=INFO
logging.level.com.focushive.identity=INFO
logging.level.org.springframework.security=INFO

# Enable health checks for Docker
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.show-details=always

# Server Configuration
server.port=8081
server.address=0.0.0.0

# JWT Configuration - Use environment variables
jwt.secret=${JWT_SECRET}
jwt.issuer=http://focushive-identity-service:8081/identity

# Admin Configuration
spring.security.user.name=${ADMIN_USERNAME:admin}
spring.security.user.password=${ADMIN_PASSWORD:Admin123!}