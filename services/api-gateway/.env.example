# FocusHive API Gateway Environment Variables
# Copy this file to .env and update the values for your environment

# ================================
# Gateway Configuration
# ================================
SERVER_PORT=8090
SPRING_PROFILES_ACTIVE=default
LOG_LEVEL=INFO

# ================================
# Redis Configuration
# ================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=gateway_redis_pass
REDIS_TIMEOUT=2000ms
REDIS_CONNECT_TIMEOUT=2000ms

# ================================
# JWT Configuration
# ================================
# CRITICAL: Use a secure 256-bit secret in production
FOCUSHIVE_JWT_SECRET=your-256-bit-secret-key-here-make-it-secure-replace-this-in-production
FOCUSHIVE_JWT_EXPIRATION=86400000

# ================================
# OAuth2 Resource Server
# ================================
SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_ISSUER_URI=http://localhost:8081
SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI=http://localhost:8081/oauth2/jwks

# ================================
# CORS Configuration
# ================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8090,http://localhost:80

# ================================
# Downstream Service URLs
# ================================
IDENTITY_SERVICE_URL=http://localhost:8081
FOCUSHIVE_BACKEND_URL=http://localhost:8080
MUSIC_SERVICE_URL=http://localhost:8082
NOTIFICATION_SERVICE_URL=http://localhost:8083
CHAT_SERVICE_URL=http://localhost:8084
ANALYTICS_SERVICE_URL=http://localhost:8085
FORUM_SERVICE_URL=http://localhost:8086
BUDDY_SERVICE_URL=http://localhost:8087

# ================================
# Rate Limiting Configuration
# ================================
# Identity Service Rate Limits
IDENTITY_RATE_LIMIT_REPLENISH=100
IDENTITY_RATE_LIMIT_BURST=200

# FocusHive Backend Rate Limits
FOCUSHIVE_RATE_LIMIT_REPLENISH=200
FOCUSHIVE_RATE_LIMIT_BURST=400

# Chat Service Rate Limits (Higher for real-time)
CHAT_RATE_LIMIT_REPLENISH=500
CHAT_RATE_LIMIT_BURST=1000

# Other Services Rate Limits
DEFAULT_RATE_LIMIT_REPLENISH=100
DEFAULT_RATE_LIMIT_BURST=200

# ================================
# Circuit Breaker Configuration
# ================================
CIRCUIT_BREAKER_SLIDING_WINDOW_SIZE=10
CIRCUIT_BREAKER_MINIMUM_CALLS=5
CIRCUIT_BREAKER_FAILURE_RATE_THRESHOLD=50
CIRCUIT_BREAKER_WAIT_DURATION=10s
CIRCUIT_BREAKER_HALF_OPEN_CALLS=3

# ================================
# Monitoring Configuration
# ================================
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus
MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS=when_authorized

# ================================
# Docker Environment Variables
# ================================
# These are used when running in Docker containers
# The gateway will use service names for Docker network communication

# Redis in Docker
DOCKER_REDIS_HOST=gateway-redis

# Services in Docker
DOCKER_IDENTITY_SERVICE_URL=http://identity-service:8081
DOCKER_FOCUSHIVE_BACKEND_URL=http://backend:8080
DOCKER_MUSIC_SERVICE_URL=http://music-service:8082
DOCKER_NOTIFICATION_SERVICE_URL=http://notification-service:8083
DOCKER_CHAT_SERVICE_URL=http://chat-service:8084
DOCKER_ANALYTICS_SERVICE_URL=http://analytics-service:8085
DOCKER_FORUM_SERVICE_URL=http://forum-service:8086
DOCKER_BUDDY_SERVICE_URL=http://buddy-service:8087

# ================================
# Development Configuration
# ================================
# Enable debug logging for development
DEV_LOG_LEVEL=DEBUG
DEV_SHOW_SQL=false

# ================================
# Production Configuration
# ================================
# Memory settings for production
JAVA_OPTS=-Xmx512m -Xms256m -XX:+UseG1GC -XX:MaxGCPauseMillis=100

# Production security settings
PROD_CORS_ORIGINS=https://focushive.com,https://*.focushive.com
PROD_SECURE_HEADERS=true

# ================================
# Monitoring & Observability
# ================================
# Prometheus metrics
PROMETHEUS_ENABLED=true

# Health check settings
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# ================================
# Security Configuration
# ================================
# Content Security Policy
CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'

# Additional security headers
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=1; mode=block

# ================================
# Performance Configuration
# ================================
# Connection pool settings
REDIS_POOL_MAX_ACTIVE=8
REDIS_POOL_MAX_IDLE=8
REDIS_POOL_MIN_IDLE=0

# Request timeout settings
REQUEST_TIMEOUT=30s
CONNECT_TIMEOUT=5s

# ================================
# Error Handling Configuration
# ================================
# Circuit breaker fallback settings
FALLBACK_ENABLED=true
FALLBACK_TIMEOUT=10s

# Retry configuration
RETRY_ENABLED=true
RETRY_MAX_ATTEMPTS=3
RETRY_BACKOFF_FIRST=50ms
RETRY_BACKOFF_MAX=500ms