<?xml version="1.0" encoding="UTF-8"?>
<suppressions xmlns="https://jeremylong.github.io/DependencyCheck/dependency-suppression.1.3.xsd">
    <!-- Suppress known false positives -->

    <!-- Spring Framework false positives -->
    <suppress>
        <notes>Spring Framework CVEs that don't affect our usage</notes>
        <gav regex="true">org\.springframework:.*</gav>
        <cve>CVE-2016-1000027</cve>
    </suppress>

    <!-- Logback false positives -->
    <suppress>
        <notes>Logback CVE that requires specific configuration we don't use</notes>
        <gav regex="true">ch\.qos\.logback:.*</gav>
        <cve>CVE-2021-42550</cve>
    </suppress>

    <!-- PostgreSQL JDBC Driver false positives -->
    <suppress>
        <notes>PostgreSQL driver CVEs that don't affect our usage</notes>
        <gav regex="true">org\.postgresql:postgresql:.*</gav>
        <vulnerabilityName regex="true">.*privilege.*escalation.*</vulnerabilityName>
    </suppress>

    <!-- Jackson Databind - suppress old CVEs that are fixed in our version -->
    <suppress>
        <notes>Jackson CVEs fixed in version 2.15+</notes>
        <gav regex="true">com\.fasterxml\.jackson\.core:jackson-databind:2\.(15|16|17)\..*</gav>
        <cve regex="true">CVE-202[0-2]-.*</cve>
    </suppress>

    <!-- Tomcat embedded - suppress if running in container -->
    <suppress>
        <notes>Tomcat CVEs when running in containerized environment</notes>
        <gav regex="true">org\.apache\.tomcat\.embed:.*</gav>
        <cve regex="true">CVE-2023-.*</cve>
        <cpe>cpe:/a:apache:tomcat</cpe>
    </suppress>

    <!-- Test dependencies - lower severity threshold -->
    <suppress>
        <notes>Test dependencies with lower risk tolerance</notes>
        <gav regex="true">.*:.*:.*:test</gav>
        <cvssBelow>7</cvssBelow>
    </suppress>

    <!-- Development tools -->
    <suppress>
        <notes>Development tools not used in production</notes>
        <gav regex="true">org\.springframework\.boot:spring-boot-devtools:.*</gav>
        <cvssBelow>9</cvssBelow>
    </suppress>
</suppressions>